<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Tools - By Goivanni Lopes</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="dictionary.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"></head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand fs-2 fw-bold" href="index.html">TheTools</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav" style="padding-left: 1em;">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="index.html">Home</a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Ferramentas
                </a>
                <ul class="dropdown-menu dropdown-menu-dark shadow" style="padding: 1em; border-radius: 1em;" aria-labelledby="navbarDropdownMenuLink">
                    <li><a class="dropdown-item" style="border-radius: .3em;" href="text-to-speech.html">Texto para Fala</a></li>
                    <li><a class="dropdown-item" style="border-radius: .3em;" href="password-generator.html">Gerador de Senha</a></li>
                    <li><a class="dropdown-item" style="border-radius: .3em;" href="music-player.html">Reprodutor de Música</a></li>
                    <li><a class="dropdown-item  bg-danger" style="border-radius: .3em;" href="dictionary.html">Dicionário</a></li>
                    
                    <li><a class="dropdown-item" style="border-radius: .3em;" href="location-fetch.html">Buscador de Localização</a></li>
                    <li><a class="dropdown-item" style="border-radius: .3em;" href="todo-list.html">Lista To-Do</a></li>
                  </ul>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <div class="wrapper">
        <header>Dicionário Americano</header>
        <div class="search">
          <input type="text" placeholder="Busque uma palavra" required spellcheck="false">
          <span class="material-icons">fechar</span>
        </div>
        <p class="info-text">Escreva uma palavra (em inglês) existente e pressione 'enter' para obter o significado, exemplo, sinônimo, etc.</p>
        <ul>
          <li class="word">
            <div class="details">
              <p>__</p>
              <span>_ _</span>
            </div>
          </li>
          <div class="content">
            <li class="meaning">
              <div class="details">
                <p>Significado</p>
                <span>___</span>
              </div>
            </li>
            <li class="example">
              <div class="details">
                <p>Exemplo</p>
                <span>___</span>
              </div>
            </li>
            <li class="synonyms">
              <div class="details">
                <p>Sinônimo</p>
                <div class="list"></div>
              </div>
            </li>
          </div>
        </ul>
      </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script></body>
    <script>
      
  const wrapper = document.querySelector(".wrapper"),
  searchInput = wrapper.querySelector("input"),
  volume = wrapper.querySelector(".word i"),
  infoText = wrapper.querySelector(".info-text"),
  synonyms = wrapper.querySelector(".synonyms .list"),
  removeIcon = wrapper.querySelector(".search span");
  let audio;

function data(result, word){
    if(result.title){
        infoText.innerHTML = `Não foi possível achar o significado de <span>"${word}"</span>. Por favor, tente buscar outra palavra`;
    }else{
        wrapper.classList.add("active");
        let definitions = result[0].meanings[0].definitions[0],
        phontetics = `${result[0].meanings[0].partOfSpeech}  /${result[0].phonetics[0].text}/`;
        document.querySelector(".word p").innerText = result[0].word;
        document.querySelector(".word span").innerText = phontetics;
        document.querySelector(".meaning span").innerText = definitions.definition;
        document.querySelector(".example span").innerText = definitions.example;
        audio = new Audio("https:" + result[0].phonetics[0].audio);

        if(definitions.synonyms[0] == undefined){
            synonyms.parentElement.style.display = "none";
        }else{
            synonyms.parentElement.style.display = "block";
            synonyms.innerHTML = "";
            for (let i = 0; i < 5; i++) {
                let tag = `<span onclick="search('${definitions.synonyms[i]}')">${definitions.synonyms[i]},</span>`;
                tag = i == 4 ? tag = `<span onclick="search('${definitions.synonyms[i]}')">${definitions.synonyms[4]}</span>` : tag;
                synonyms.insertAdjacentHTML("beforeend", tag);
            }
        }
    }
}

function search(word){
    fetchApi(word);
    searchInput.value = word;
}

function fetchApi(word){
    wrapper.classList.remove("active");
    infoText.style.color = "#000";
    infoText.innerHTML = `Buscando o significado de <span>"${word}"</span>`;
    let url = `https://api.dictionaryapi.dev/api/v2/entries/en/${word}`;
    fetch(url).then(response => response.json()).then(result => data(result, word)).catch(() =>{
        infoText.innerHTML = `Não foi possível achar o significado de <span>"${word}"</span>. Por favor, tente buscar outra palavra`;
    });
}

searchInput.addEventListener("keyup", e =>{
    let word = e.target.value.replace(/\s+/g, ' ');
    if(e.key == "Enter" && word){
        fetchApi(word);
    }
});

volume.addEventListener("click", ()=>{
    volume.style.color = "#4D59FB";
    audio.play();
    setTimeout(() =>{
        volume.style.color = "#999";
    }, 800);
});

removeIcon.addEventListener("click", ()=>{
    searchInput.value = "";
    searchInput.focus();
    wrapper.classList.remove("active");
    infoText.style.color = "#9A9A9A";
    infoText.innerHTML = "Escreva uma palavra existente e pressione 'enter' para obter o significado, exemplo, sinônimo, etc.";
});
    </script>
</html>